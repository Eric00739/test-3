# 部署前检查清单

## 已完成的修复 ✅

### 1. 构建错误修复
- [x] 修复了 page.tsx 中的 metadata 导出问题
- [x] 分离了客户端和服务器组件
- [x] 修复了动态导入的 TypeScript 类型错误
- [x] 清理了不必要的状态和效果逻辑

### 2. i18n 回退系统
- [x] 实现了英语回退机制
- [x] 添加了错误处理和日志记录
- [注意] 构建日志中仍提示多语言缺词（如 hero.*、taskRouting），这是现有的 i18n 待办

### 3. GitHub Actions 工作流
- [x] 添加了正确的 `id: pages` 到 configure-pages 操作
- [x] 移除了不必要的 `NEXT_PUBLIC_BASE_URL` 环境变量

## 部署前验证步骤

### 1. 本地构建验证
```bash
# 类型检查
npm run type-check

# 构建验证
npm run build

# 启动生产构建验证
npm run start
```

### 2. 关键文件检查
- [x] `src/app/[locale]/page.tsx` - 只导出 metadata 并渲染 HomeClient
- [x] `src/app/[locale]/HomeClient.tsx` - 包含所有客户端逻辑
- [x] `src/i18n/get-messages.ts` - 实现了回退机制
- [x] `.github/workflows/deploy.yml` - 修复了工作流配置

### 3. 多语言处理
- [x] 英语翻译完整
- [ ] 其他语言翻译不完整（pt, es, fr, it 缺失 hero, taskRouting, compatibility, process 等键）
- [x] 已实现回退机制，构建时会显示错误但会完成
- [ ] 如需完整的多语言支持，需要补充缺失的翻译（见 BUILD_I18N_ERRORS.md）

## 预期构建输出

构建成功后应该看到：
1. 无 TypeScript 错误
2. 无 ESLint 错误
3. 静态文件生成到 `./out` 目录
4. 多语言路由正确生成

## GitHub Pages 部署注意事项

1. **推送前验证**：建议推送前再运行一次 `npm run build`
2. **多语言路由**：确保所有语言路由都能正确访问
3. **静态资源**：确认所有图片和静态资源都能正确加载
4. **CNAME 文件**：如果使用自定义域名，确保 CNAME 文件在 `public` 目录中

## 可能的警告和解决方案

### 1. 多语言缺词警告
**警告**：构建日志中提示多语言缺词（如 hero.*、taskRouting）
**解决方案**：
- 短期：已实现的英语回退机制会处理
- 长期：补充缺失的翻译文件

### 2. 图片优化警告
**警告**：可能有关图片优化的警告
**解决方案**：
- 检查图片路径是否正确
- 确认图片文件存在

### 3. 动态导入警告
**警告**：可能有关于动态导入的警告
**解决方案**：
- 已修复类型错误
- 确认所有动态导入都有正确的加载状态

## 部署后验证

部署完成后，验证以下内容：
1. 所有页面都能正确加载
2. 多语言路由工作正常
3. 所有交互元素功能正常
4. 移动端响应式正常
5. 图片和静态资源加载正确

## 回滚计划

如果部署出现问题：
1. 检查构建日志中的错误
2. 回退到上一个稳定版本
3. 修复问题后重新部署

## 联系信息

如有部署问题，请检查：
1. GitHub Actions 工作流日志
2. 构建错误信息
3. 控制台错误信息